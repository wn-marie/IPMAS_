# ðŸ—ï¸ Build Setup for Monorepo

This document explains the build setup for the IPMAS monorepo.

## ðŸ“ Repository Structure

```
IPMAS/
â”œâ”€â”€ backend/          # Node.js/Express backend
â”œâ”€â”€ frontend/         # Frontend application
â”‚   â”œâ”€â”€ public/       # Source files (development)
â”‚   â””â”€â”€ dist/         # Built files (production) - generated by build
â””â”€â”€ package.json      # Root package.json with workspace scripts
```

## ðŸ”¨ Build Process

### Frontend Build

The frontend uses **Webpack** to build static files from `frontend/public/` to `frontend/dist/`.

**Build Command:**
```bash
cd frontend
npm run build
```

**What it does:**
- Copies all files from `public/` to `dist/`
- Optimizes assets for production
- Outputs to `frontend/dist/` folder

**Build Output:**
- All HTML, CSS, JS files copied to `dist/`
- Maintains directory structure
- Ready for production deployment

### Backend

The backend serves the built frontend files:
- **Production**: Serves from `frontend/dist/` (if exists)
- **Development**: Falls back to `frontend/public/`

**Port Configuration:**
- Uses `process.env.PORT` (automatically set by Render)
- Falls back to `3001` for local development
- âœ… Ready for Render deployment

## ðŸ“œ Available Scripts

### Root Level (`package.json`)

```bash
# Install all dependencies
npm run install:all

# Build frontend
npm run build

# Build everything (frontend + backend deps)
npm run build:all

# Start backend (serves frontend from dist/)
npm start

# Development mode (both frontend and backend)
npm run dev
```

### Frontend (`frontend/package.json`)

```bash
# Build for production
npm run build

# Build for development
npm run build:dev

# Start development server
npm run dev

# Start production server (serves dist/)
npm start
```

### Backend (`backend/package.json`)

```bash
# Start production server
npm start

# Start development server (with nodemon)
npm run dev
```

## ðŸš€ Render Deployment

### Build Command (Render)
```bash
npm run install:all && cd frontend && npm run build && cd ../backend && npm install
```

### Start Command (Render)
```bash
cd backend && npm start
```

**What happens:**
1. All dependencies are installed
2. Frontend is built to `frontend/dist/`
3. Backend dependencies are installed
4. Backend starts and serves from `frontend/dist/`

## âœ… Verification

### Check Build Output
```bash
# Build the frontend
cd frontend
npm run build

# Verify dist/ folder exists
ls -la dist/

# Should see: index.html, scripts/, styles/, etc.
```

### Test Locally
```bash
# Build frontend
npm run build

# Start backend (will serve from dist/)
npm start

# Visit http://localhost:3001
```

## ðŸ“ Notes

- **`frontend/dist/`** is in `.gitignore` (generated files)
- **`frontend/public/`** contains source files (committed)
- Backend automatically detects and serves from `dist/` if available
- PORT is automatically handled by Render (no configuration needed)

## ðŸ”§ Troubleshooting

### Build Fails
- Check Node.js version (>= 18.0.0)
- Run `npm install` in `frontend/` directory
- Check webpack.config.js for errors

### Frontend Not Loading
- Verify `frontend/dist/` exists after build
- Check backend logs for file serving errors
- Ensure build completed successfully

### Port Issues
- Backend uses `process.env.PORT` (Render sets this automatically)
- No manual PORT configuration needed

---

**Ready for Deployment!** âœ…

